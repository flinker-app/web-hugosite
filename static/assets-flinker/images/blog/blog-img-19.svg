<svg xmlns="http://www.w3.org/2000/svg" width="923" height="480" viewBox="0 0 923 480" role="img" aria-label="Policy layer architecture: SPFx app running inside SharePoint tenant">
  <defs>
    <linearGradient id="accCtx" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0" stop-color="#1E6BFF"/>
      <stop offset="0.55" stop-color="#00B7C3"/>
      <stop offset="1" stop-color="#20C997"/>
    </linearGradient>
    <linearGradient id="borderGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#1E6BFF"/>
      <stop offset="0.5" stop-color="#00B7C3"/>
      <stop offset="1" stop-color="#20C997"/>
    </linearGradient>
    <filter id="dsMain" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="8" stdDeviation="16" flood-color="#0B1B3A" flood-opacity="0.12"/>
    </filter>
    <filter id="dsSoft" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#0B1B3A" flood-opacity="0.06"/>
    </filter>
    <style>
      .cap{font:600 10px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#94A3B8; letter-spacing:.05em; text-transform:uppercase}
      .lbl{font:600 12px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#64748B}
      .lbl-main{font:700 13px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#0B1B3A}
      .lbl-tenant{font:600 11px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#1E6BFF}
      .mini{font:500 10px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#94A3B8}
      .mini-main{font:500 10px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#64748B}
      .badge{font:600 9px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#1E6BFF; letter-spacing:.03em}
    </style>
  </defs>

  <!-- Background -->
  <rect x="0" y="0" width="923" height="480" rx="20" fill="#F8FAFC"/>

  <!-- Left: Ingress channels (external) -->
  <g transform="translate(32 32)">
    <rect x="0" y="0" width="200" height="416" rx="12" fill="#FFFFFF" filter="url(#dsSoft)"/>
    <rect x="0" y="0" width="200" height="40" rx="12" fill="#F1F5F9"/>
    <rect x="0" y="28" width="200" height="12" fill="#F1F5F9"/>
    <text class="lbl" x="14" y="26">Ingress Channels</text>

    <g transform="translate(14 54)">
      <g transform="translate(0 0)">
        <rect x="0" y="0" width="172" height="44" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
        <rect x="10" y="10" width="24" height="24" rx="6" fill="#EBF4FF"/>
        <path d="M18 16h10a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H18a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2z" fill="none" stroke="#1E6BFF" stroke-width="1" opacity="0.6"/>
        <text class="lbl" x="42" y="24">SharePoint UI</text>
        <text class="mini" x="42" y="36">Upload / edit</text>
      </g>

      <g transform="translate(0 52)">
        <rect x="0" y="0" width="172" height="44" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
        <rect x="10" y="10" width="24" height="24" rx="6" fill="#E6FAFA"/>
        <path d="M16 28c5 0 5-8 10-8s5 8 10 8" fill="none" stroke="#00B7C3" stroke-width="1" stroke-linecap="round" opacity="0.6"/>
        <text class="lbl" x="42" y="24">Sync client</text>
        <text class="mini" x="42" y="36">OneDrive</text>
      </g>

      <g transform="translate(0 104)">
        <rect x="0" y="0" width="172" height="44" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
        <rect x="10" y="10" width="24" height="24" rx="6" fill="#ECFDF5"/>
        <path d="M16 28h14m-14-5h14m-14-5h10" fill="none" stroke="#20C997" stroke-width="1" stroke-linecap="round" opacity="0.6"/>
        <text class="lbl" x="42" y="24">External tools</text>
        <text class="mini" x="42" y="36">BIM / CAD</text>
      </g>

      <g transform="translate(0 156)">
        <rect x="0" y="0" width="172" height="44" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
        <rect x="10" y="10" width="24" height="24" rx="6" fill="#F1F5F9"/>
        <path d="M16 22h12M16 28h8" fill="none" stroke="#64748B" stroke-width="1" stroke-linecap="round" opacity="0.5"/>
        <path d="M26 18l3 3-3 3" fill="none" stroke="#64748B" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" opacity="0.5"/>
        <text class="lbl" x="42" y="24">APIs</text>
        <text class="mini" x="42" y="36">Integrations</text>
      </g>
    </g>
  </g>

  <!-- Right: Client SharePoint Tenant (contains everything) -->
  <g transform="translate(260 16)">
    <!-- Tenant container -->
    <rect x="0" y="0" width="631" height="448" rx="16" fill="#FFFFFF" stroke="#1E6BFF" stroke-width="2" stroke-dasharray="6 4" filter="url(#dsMain)"/>

    <!-- Tenant header -->
    <rect x="0" y="0" width="631" height="44" rx="16" fill="#EBF4FF"/>
    <rect x="0" y="28" width="631" height="16" fill="#EBF4FF"/>

    <!-- Microsoft 365 icon -->
    <g transform="translate(16 12)">
      <rect x="0" y="0" width="20" height="20" rx="4" fill="#1E6BFF"/>
      <rect x="2" y="2" width="7" height="7" rx="1" fill="#FFFFFF"/>
      <rect x="11" y="2" width="7" height="7" rx="1" fill="#FFFFFF"/>
      <rect x="2" y="11" width="7" height="7" rx="1" fill="#FFFFFF"/>
      <rect x="11" y="11" width="7" height="7" rx="1" fill="#FFFFFF"/>
    </g>
    <text class="lbl-tenant" x="44" y="26">Your SharePoint / Microsoft 365 Tenant</text>
    <text class="mini" x="280" y="26">(self-hosted, data stays in your tenant)</text>

    <!-- Inner content area -->
    <g transform="translate(16 60)">

      <!-- Flinker Policy Layer (SPFx App) - inside tenant -->
      <g transform="translate(0 0)">
        <!-- Gradient border -->
        <rect x="0" y="0" width="290" height="372" rx="14" fill="url(#borderGrad)"/>
        <rect x="2" y="2" width="286" height="368" rx="12" fill="#FFFFFF"/>

        <!-- SPFx badge -->
        <g transform="translate(200 12)">
          <rect x="0" y="0" width="72" height="20" rx="10" fill="#EBF4FF" stroke="#1E6BFF" stroke-width="1"/>
          <text class="badge" x="10" y="14">SPFx App</text>
        </g>

        <!-- Header -->
        <rect x="2" y="2" width="286" height="52" rx="12" fill="url(#accCtx)" opacity="0.1"/>
        <rect x="2" y="40" width="286" height="14" fill="url(#accCtx)" opacity="0.1"/>
        <text class="lbl-main" x="16" y="32">Flinker Policy Layer</text>

        <!-- Policy blueprint -->
        <g transform="translate(14 66)">
          <rect x="0" y="0" width="260" height="100" rx="10" fill="#FFFFFF" stroke="#E2E8F0" stroke-width="1"/>
          <rect x="0" y="0" width="260" height="28" rx="10" fill="#F8FAFC"/>
          <rect x="0" y="18" width="260" height="10" fill="#F8FAFC"/>
          <text class="cap" x="12" y="18" fill="#64748B">Policy Blueprint</text>

          <g transform="translate(10 38)">
            <g transform="translate(0 0)">
              <rect x="0" y="0" width="115" height="24" rx="5" fill="#EBF4FF"/>
              <text class="mini-main" x="8" y="16">naming: pattern</text>
            </g>
            <g transform="translate(122 0)">
              <rect x="0" y="0" width="115" height="24" rx="5" fill="#E6FAFA"/>
              <text class="mini-main" x="8" y="16">metadata: [...]</text>
            </g>
            <g transform="translate(0 30)">
              <rect x="0" y="0" width="115" height="24" rx="5" fill="#ECFDF5"/>
              <text class="mini-main" x="8" y="16">states: WIP→Pub</text>
            </g>
            <g transform="translate(122 30)">
              <rect x="0" y="0" width="115" height="24" rx="5" fill="#FEF3C7"/>
              <text class="mini-main" x="8" y="16">approvals: {...}</text>
            </g>
          </g>
        </g>

        <!-- Release gate -->
        <g transform="translate(14 178)">
          <rect x="0" y="0" width="260" height="80" rx="10" fill="#0F172A" opacity="0.02"/>
          <rect x="0" y="0" width="260" height="80" rx="10" fill="none" stroke="url(#borderGrad)" stroke-width="1" opacity="0.3"/>
          <text class="lbl-main" x="12" y="24">Release Gate</text>
          <text class="mini-main" x="12" y="40">Block until compliant</text>

          <!-- Lock icon -->
          <g transform="translate(200 12)">
            <rect x="0" y="0" width="44" height="52" rx="8" fill="#FFFFFF" stroke="#E2E8F0" stroke-width="1"/>
            <path d="M12 24v-5a10 10 0 0 1 20 0v5" fill="none" stroke="#1E6BFF" stroke-width="1.5" stroke-linecap="round"/>
            <rect x="10" y="24" width="24" height="18" rx="5" fill="#EBF4FF" stroke="#1E6BFF" stroke-width="1"/>
            <circle cx="22" cy="33" r="2.5" fill="#1E6BFF"/>
          </g>

          <g transform="translate(12 50)">
            <path d="M0 8l4 4 8-8" fill="none" stroke="#20C997" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <text class="mini-main" x="18" y="12">Naming</text>
            <g transform="translate(80 0)">
              <path d="M0 8l4 4 8-8" fill="none" stroke="#20C997" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <text class="mini-main" x="18" y="12">Metadata</text>
            </g>
          </g>
        </g>

        <!-- Logging -->
        <g transform="translate(14 270)">
          <rect x="0" y="0" width="260" height="52" rx="10" fill="#FFFFFF" stroke="#E2E8F0" stroke-width="1"/>
          <text class="lbl-main" x="12" y="22">Logging</text>
          <text class="mini-main" x="12" y="38">Issues • Events • Evidence</text>
          <g transform="translate(208 18)">
            <circle cx="0" cy="0" r="4" fill="#1E6BFF"/>
            <circle cx="12" cy="0" r="4" fill="#00B7C3"/>
            <circle cx="24" cy="0" r="4" fill="#20C997"/>
          </g>
        </g>

        <!-- Runs inside indicator -->
        <g transform="translate(14 334)">
          <rect x="0" y="0" width="260" height="28" rx="6" fill="#F0FDF4" stroke="#BBF7D0" stroke-width="1"/>
          <circle cx="16" cy="14" r="4" fill="#22C55E"/>
          <text class="mini-main" x="28" y="18" fill="#166534">Runs inside your tenant</text>
        </g>
      </g>

      <!-- SharePoint CDE (Document Libraries) -->
      <g transform="translate(306 0)">
        <rect x="0" y="0" width="290" height="372" rx="12" fill="#FFFFFF" stroke="#E2E8F0" stroke-width="1.5"/>
        <rect x="0" y="0" width="290" height="44" rx="12" fill="#F5F7FA"/>
        <rect x="0" y="32" width="290" height="12" fill="#F5F7FA"/>
        <text class="lbl-main" x="16" y="28">SharePoint Document Libraries</text>

        <!-- Lifecycle -->
        <g transform="translate(14 58)">
          <text class="cap" x="0" y="0">Information States (Lifecycle)</text>

          <g transform="translate(0 14)">
            <rect x="0" y="0" width="262" height="36" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
            <text class="lbl" x="12" y="23">WIP</text>
            <text class="mini" x="50" y="23">Work in progress</text>
            <rect x="160" y="10" width="90" height="16" rx="8" fill="#EBF4FF"/>
          </g>

          <g transform="translate(0 44)">
            <rect x="0" y="0" width="262" height="36" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
            <text class="lbl" x="12" y="23">Shared</text>
            <text class="mini" x="62" y="23">Coordination</text>
            <rect x="160" y="10" width="90" height="16" rx="8" fill="#E6FAFA"/>
          </g>

          <g transform="translate(0 88)">
            <rect x="0" y="0" width="262" height="36" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
            <text class="lbl" x="12" y="23">Published</text>
            <text class="mini" x="80" y="23">Deliverables</text>
            <rect x="160" y="10" width="90" height="16" rx="8" fill="#ECFDF5"/>
          </g>

          <g transform="translate(0 132)">
            <rect x="0" y="0" width="262" height="36" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
            <text class="lbl" x="12" y="23">Archived</text>
            <text class="mini" x="72" y="23">Retention</text>
            <rect x="160" y="10" width="90" height="16" rx="8" fill="#F1F5F9"/>
          </g>
        </g>

        <!-- Metadata & Versioning -->
        <g transform="translate(14 246)">
          <rect x="0" y="0" width="262" height="52" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
          <text class="cap" x="12" y="20">Metadata &amp; Versioning</text>
          <text class="mini" x="12" y="38">Native SharePoint capabilities</text>
        </g>

        <!-- Audit trail -->
        <g transform="translate(14 310)">
          <rect x="0" y="0" width="262" height="52" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
          <text class="cap" x="12" y="20">Audit Trail</text>
          <text class="mini" x="12" y="38">Approvals • Blocks • Versions</text>
        </g>
      </g>
    </g>
  </g>

  <!-- Connection arrows -->
  <g fill="none" stroke-linecap="round">
    <!-- Ingress -> Tenant (converging to Flinker) -->
    <path d="M232 98 Q250 98, 250 180 Q250 240, 276 240" stroke="#CBD5E1" stroke-width="1.5" stroke-dasharray="4 3"/>
    <path d="M232 150 Q250 150, 250 195 Q250 240, 276 240" stroke="#CBD5E1" stroke-width="1.5" stroke-dasharray="4 3"/>
    <path d="M232 202 Q250 202, 250 221 Q250 240, 276 240" stroke="#CBD5E1" stroke-width="1.5" stroke-dasharray="4 3"/>
    <path d="M232 254 Q250 254, 250 247 Q250 240, 276 240" stroke="#CBD5E1" stroke-width="1.5" stroke-dasharray="4 3"/>

    <!-- Flinker -> SharePoint (inside tenant) -->
    <path d="M566 240 L582 240" stroke="url(#borderGrad)" stroke-width="2"/>
    <path d="M576 234 L582 240 L576 246" fill="none" stroke="url(#borderGrad)" stroke-width="2" stroke-linejoin="round"/>
  </g>
</svg>